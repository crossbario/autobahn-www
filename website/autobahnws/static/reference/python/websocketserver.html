<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Server &mdash; AutobahnPython 0.5.14 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.5.14',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="AutobahnPython 0.5.14 documentation" href="index.html" />
    <link rel="up" title="WebSocket" href="websockettoc.html" />
    <link rel="next" title="Auxiliary" href="websocketaux.html" />
    <link rel="prev" title="Client" href="websocketclient.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="websocketaux.html" title="Auxiliary"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="websocketclient.html" title="Client"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">AutobahnPython 0.5.14 documentation</a> &raquo;</li>
          <li><a href="websockettoc.html" accesskey="U">WebSocket</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Server</a><ul>
<li><a class="reference internal" href="#factory">Factory</a></li>
<li><a class="reference internal" href="#protocol">Protocol</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="websocketclient.html"
                        title="previous chapter">Client</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="websocketaux.html"
                        title="next chapter">Auxiliary</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/websocketserver.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="server">
<h1>Server<a class="headerlink" href="#server" title="Permalink to this headline">¶</a></h1>
<p>The classes <a class="reference internal" href="#autobahn.websocket.WebSocketServerProtocol" title="autobahn.websocket.WebSocketServerProtocol"><tt class="xref py py-class docutils literal"><span class="pre">autobahn.websocket.WebSocketServerProtocol</span></tt></a> and
<a class="reference internal" href="#autobahn.websocket.WebSocketServerFactory" title="autobahn.websocket.WebSocketServerFactory"><tt class="xref py py-class docutils literal"><span class="pre">autobahn.websocket.WebSocketServerFactory</span></tt></a> are the base classes
you derive from to implement WebSocket servers.</p>
<div class="section" id="factory">
<h2>Factory<a class="headerlink" href="#factory" title="Permalink to this headline">¶</a></h2>
<p>To create your actual server, you need a factory with the protocol attribute
set to your protocol.</p>
<p>You may either use <a class="reference internal" href="#autobahn.websocket.WebSocketServerFactory" title="autobahn.websocket.WebSocketServerFactory"><tt class="xref py py-class docutils literal"><span class="pre">autobahn.websocket.WebSocketServerFactory</span></tt></a> directly
and without modification or you can derive from that class when you want to
extend it&#8217;s behavior i.e. with state that is available for all client connections.</p>
<dl class="class">
<dt id="autobahn.websocket.WebSocketServerFactory">
<em class="property">class </em><tt class="descclassname">autobahn.websocket.</tt><tt class="descname">WebSocketServerFactory</tt><big>(</big><em>url=None</em>, <em>protocols=</em><span class="optional">[</span><span class="optional">]</span>, <em>server='AutobahnPython/0.5.14'</em>, <em>debug=False</em>, <em>debugCodePaths=False</em>, <em>externalPort=None</em><big>)</big><a class="headerlink" href="#autobahn.websocket.WebSocketServerFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>A Twisted factory for WebSockets server protocols.</p>
<dl class="method">
<dt id="autobahn.websocket.WebSocketServerFactory.__init__">
<tt class="descname">__init__</tt><big>(</big><em>url=None</em>, <em>protocols=</em><span class="optional">[</span><span class="optional">]</span>, <em>server='AutobahnPython/0.5.14'</em>, <em>debug=False</em>, <em>debugCodePaths=False</em>, <em>externalPort=None</em><big>)</big><a class="headerlink" href="#autobahn.websocket.WebSocketServerFactory.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create instance of WebSocket server factory.</p>
<p>Note that you MUST set URL either here or using setSessionParameters() _before_ the factory is started.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>url</strong> (<em>str</em>) &#8211; WebSocket listening URL - (&#8220;ws:&#8221; | &#8220;wss:&#8221;) &#8220;//&#8221; host [ &#8221;:&#8221; port ] path [ &#8221;?&#8221; query ].</li>
<li><strong>protocols</strong> (<em>list of strings</em>) &#8211; List of subprotocols the server supports. The subprotocol used is the first from the list of subprotocols announced by the client that is contained in this list.</li>
<li><strong>server</strong> (<em>str</em>) &#8211; Server as announced in HTTP response header during opening handshake or None (default: &#8220;AutobahnWebSockets/x.x.x&#8221;).</li>
<li><strong>debug</strong> (<em>bool</em>) &#8211; Debug mode (default: False).</li>
<li><strong>debugCodePaths</strong> (<em>bool</em>) &#8211; Debug code paths mode (default: False).</li>
<li><strong>externalPort</strong> (<em>int</em>) &#8211; Optionally, the external visible port this server will be reachable under (i.e. when running behind a L2/L3 forwarding device).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="autobahn.websocket.WebSocketServerFactory.getConnectionCount">
<tt class="descname">getConnectionCount</tt><big>(</big><big>)</big><a class="headerlink" href="#autobahn.websocket.WebSocketServerFactory.getConnectionCount" title="Permalink to this definition">¶</a></dt>
<dd><p>Get number of currently connected clients.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">int &#8211; Number of currently connected clients.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="autobahn.websocket.WebSocketServerFactory.protocol">
<tt class="descname">protocol</tt><a class="headerlink" href="#autobahn.websocket.WebSocketServerFactory.protocol" title="Permalink to this definition">¶</a></dt>
<dd><p>The protocol to be spoken. Must be derived from <a class="reference internal" href="#autobahn.websocket.WebSocketServerProtocol" title="autobahn.websocket.WebSocketServerProtocol"><tt class="xref py py-class docutils literal"><span class="pre">autobahn.websocket.WebSocketServerProtocol</span></tt></a>.</p>
<p>alias of <tt class="xref py py-class docutils literal"><span class="pre">WebSocketServerProtocol</span></tt></p>
</dd></dl>

<dl class="method">
<dt id="autobahn.websocket.WebSocketServerFactory.resetProtocolOptions">
<tt class="descname">resetProtocolOptions</tt><big>(</big><big>)</big><a class="headerlink" href="#autobahn.websocket.WebSocketServerFactory.resetProtocolOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset all WebSocket protocol options to defaults.</p>
</dd></dl>

<dl class="method">
<dt id="autobahn.websocket.WebSocketServerFactory.setProtocolOptions">
<tt class="descname">setProtocolOptions</tt><big>(</big><em>versions=None</em>, <em>allowHixie76=None</em>, <em>webStatus=None</em>, <em>utf8validateIncoming=None</em>, <em>maskServerFrames=None</em>, <em>requireMaskedClientFrames=None</em>, <em>applyMask=None</em>, <em>maxFramePayloadSize=None</em>, <em>maxMessagePayloadSize=None</em>, <em>autoFragmentSize=None</em>, <em>failByDrop=None</em>, <em>echoCloseCodeReason=None</em>, <em>openHandshakeTimeout=None</em>, <em>closeHandshakeTimeout=None</em>, <em>tcpNoDelay=None</em><big>)</big><a class="headerlink" href="#autobahn.websocket.WebSocketServerFactory.setProtocolOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Set WebSocket protocol options used as defaults for new protocol instances.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>versions</strong> (<em>list of ints</em>) &#8211; The WebSockets protocol versions accepted by the server (default: WebSocketProtocol.SUPPORTED_PROTOCOL_VERSIONS).</li>
<li><strong>allowHixie76</strong> (<em>bool</em>) &#8211; Allow to speak Hixie76 protocol version.</li>
<li><strong>webStatus</strong> (<em>bool</em>) &#8211; Return server status/version on HTTP/GET without WebSocket upgrade header (default: True).</li>
<li><strong>utf8validateIncoming</strong> (<em>bool</em>) &#8211; Validate incoming UTF-8 in text message payloads (default: True).</li>
<li><strong>maskServerFrames</strong> (<em>bool</em>) &#8211; Mask server-to-client frames (default: False).</li>
<li><strong>requireMaskedClientFrames</strong> (<em>bool</em>) &#8211; Require client-to-server frames to be masked (default: True).</li>
<li><strong>applyMask</strong> (<em>bool</em>) &#8211; Actually apply mask to payload when mask it present. Applies for outgoing and incoming frames (default: True).</li>
<li><strong>maxFramePayloadSize</strong> (<em>int</em>) &#8211; Maximum frame payload size that will be accepted when receiving or 0 for unlimited (default: 0).</li>
<li><strong>maxMessagePayloadSize</strong> (<em>int</em>) &#8211; Maximum message payload size (after reassembly of fragmented messages) that will be accepted when receiving or 0 for unlimited (default: 0).</li>
<li><strong>autoFragmentSize</strong> (<em>int</em>) &#8211; Automatic fragmentation of outgoing data messages (when using the message-based API) into frames with payload length &lt;= this size or 0 for no auto-fragmentation (default: 0).</li>
<li><strong>failByDrop</strong> &#8211; Fail connections by dropping the TCP connection without performaing closing handshake (default: True).</li>
<li><strong>echoCloseCodeReason</strong> (<em>bool</em>) &#8211; Iff true, when receiving a close, echo back close code/reason. Otherwise reply with code == NORMAL, reason = &#8220;&#8221; (default: False).</li>
<li><strong>openHandshakeTimeout</strong> (<em>float</em>) &#8211; Opening WebSocket handshake timeout, timeout in seconds or 0 to deactivate (default: 0).</li>
<li><strong>closeHandshakeTimeout</strong> (<em>float</em>) &#8211; When we expect to receive a closing handshake reply, timeout in seconds (default: 1).</li>
<li><strong>tcpNoDelay</strong> (<em>bool</em>) &#8211; TCP NODELAY (&#8220;Nagle&#8221;) socket option (default: True).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="autobahn.websocket.WebSocketServerFactory.setSessionParameters">
<tt class="descname">setSessionParameters</tt><big>(</big><em>url=None</em>, <em>protocols=</em><span class="optional">[</span><span class="optional">]</span>, <em>server=None</em>, <em>externalPort=None</em><big>)</big><a class="headerlink" href="#autobahn.websocket.WebSocketServerFactory.setSessionParameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Set WebSocket session parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>url</strong> (<em>str</em>) &#8211; WebSocket listening URL - (&#8220;ws:&#8221; | &#8220;wss:&#8221;) &#8220;//&#8221; host [ &#8221;:&#8221; port ].</li>
<li><strong>protocols</strong> (<em>list of strings</em>) &#8211; List of subprotocols the server supports. The subprotocol used is the first from the list of subprotocols announced by the client that is contained in this list.</li>
<li><strong>server</strong> (<em>str</em>) &#8211; Server as announced in HTTP response header during opening handshake.</li>
<li><strong>externalPort</strong> (<em>int</em>) &#8211; Optionally, the external visible port this server will be reachable under (i.e. when running behind a L2/L3 forwarding device).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="autobahn.websocket.WebSocketServerFactory.startFactory">
<tt class="descname">startFactory</tt><big>(</big><big>)</big><a class="headerlink" href="#autobahn.websocket.WebSocketServerFactory.startFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by Twisted before starting to listen on port for incoming connections.
Default implementation does nothing. Override in derived class when appropriate.</p>
</dd></dl>

<dl class="method">
<dt id="autobahn.websocket.WebSocketServerFactory.stopFactory">
<tt class="descname">stopFactory</tt><big>(</big><big>)</big><a class="headerlink" href="#autobahn.websocket.WebSocketServerFactory.stopFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by Twisted before stopping to listen on port for incoming connections.
Default implementation does nothing. Override in derived class when appropriate.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="protocol">
<h2>Protocol<a class="headerlink" href="#protocol" title="Permalink to this headline">¶</a></h2>
<p>Usually, you implement your WebSocket server by creating a protocol that
derives from <a class="reference internal" href="#autobahn.websocket.WebSocketServerProtocol" title="autobahn.websocket.WebSocketServerProtocol"><tt class="xref py py-class docutils literal"><span class="pre">autobahn.websocket.WebSocketServerProtocol</span></tt></a>.</p>
<p>This class in turn derives from <a class="reference internal" href="websocketbase.html#autobahn.websocket.WebSocketProtocol" title="autobahn.websocket.WebSocketProtocol"><tt class="xref py py-class docutils literal"><span class="pre">autobahn.websocket.WebSocketProtocol</span></tt></a>,
which is where you find all the callbacks and methods.</p>
<dl class="class">
<dt id="autobahn.websocket.WebSocketServerProtocol">
<em class="property">class </em><tt class="descclassname">autobahn.websocket.</tt><tt class="descname">WebSocketServerProtocol</tt><a class="headerlink" href="#autobahn.websocket.WebSocketServerProtocol" title="Permalink to this definition">¶</a></dt>
<dd><p>A Twisted protocol for WebSockets servers.</p>
<dl class="method">
<dt id="autobahn.websocket.WebSocketServerProtocol.connectionLost">
<tt class="descname">connectionLost</tt><big>(</big><em>reason</em><big>)</big><a class="headerlink" href="#autobahn.websocket.WebSocketServerProtocol.connectionLost" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by Twisted when established TCP connection from client was lost. Default
implementation will tear down all state properly.
When overriding in derived class, make sure to call this base class
implementation _after_ your code.</p>
</dd></dl>

<dl class="method">
<dt id="autobahn.websocket.WebSocketServerProtocol.connectionMade">
<tt class="descname">connectionMade</tt><big>(</big><big>)</big><a class="headerlink" href="#autobahn.websocket.WebSocketServerProtocol.connectionMade" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by Twisted when new TCP connection from client was accepted. Default
implementation will prepare for initial WebSocket opening handshake.
When overriding in derived class, make sure to call this base class
implementation _before_ your code.</p>
</dd></dl>

<dl class="method">
<dt id="autobahn.websocket.WebSocketServerProtocol.onConnect">
<tt class="descname">onConnect</tt><big>(</big><em>connectionRequest</em><big>)</big><a class="headerlink" href="#autobahn.websocket.WebSocketServerProtocol.onConnect" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback fired during WebSocket opening handshake when new WebSocket client
connection is about to be established.</p>
<p>Throw HttpException when you don&#8217;t want to accept the WebSocket
connection request. For example, throw a
HttpException(httpstatus.HTTP_STATUS_CODE_UNAUTHORIZED[0], &#8220;You are not authorized for this!&#8221;).</p>
<p>When you want to accept the connection, return the accepted protocol
from list of WebSockets (sub)protocols provided by client or None to
speak no specific one or when the client list was empty.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>connectionRequest</strong> (instance of <a class="reference internal" href="websocketaux.html#autobahn.websocket.ConnectionRequest" title="autobahn.websocket.ConnectionRequest"><tt class="xref py py-class docutils literal"><span class="pre">autobahn.websocket.ConnectionRequest</span></tt></a>) &#8211; WebSocket connection request information.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="websocketaux.html" title="Auxiliary"
             >next</a> |</li>
        <li class="right" >
          <a href="websocketclient.html" title="Client"
             >previous</a> |</li>
        <li><a href="index.html">AutobahnPython 0.5.14 documentation</a> &raquo;</li>
          <li><a href="websockettoc.html" >WebSocket</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011,2012 Tavendo GmbH.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>