{% extends "layout_tpnd.html" %}

{% block subsubheader %}
   <meta name="description" content="Getting started with AutobahnPython. Installation, a first server and where to find more information.">
   <link rel="stylesheet" href="{{ url_for('static', filename='css/page_tpsd_getstarted.css') }}">
{% endblock%}


{% block pagecontent %}

   <div class="pagewrapper">

      <a name="top"></a>
      <h1>Get started with {{ autobahnpython() }}</h1>
      <p>
         This short intro will get you started with {{ autobahnpython() }} in no time:
         <div style="margin-left: 40px;">
            <ul>
               <li><a href="#installation">Installation</a></li>
               <li><a href="#yourfirstserver">Your first Server</a></li>
               <li><a href="#wheretogo">Where to go now</a></li>
            </ul>
         </div>
      </p>
      <br>


      <a name="installation"></a>
      <h1>Installation</h1>

      <p>{{ autobahnpython() }} is available as a pre-built <a href="http://pypi.python.org/pypi/autobahn" target="_blank">package</a>
      from the Python Package Index (PyPi) and as <a href="https://github.com/tavendo/AutobahnPython" target="_blank">source code</a> on GitHub.</p>

      <a name="requirements"></a>
      <h2>Requirements</h2>

      <p>
         A prerequisite is (obviously) <a href="http://www.python.org/" target="_blank">Python</a>.
         {{ autobahnpython() }} is compatible with Python 2 and Python 3, and runs on <a href="http://python.org/">CPython</a>, <a href="http://pypy.org/">PyPy</a> and <a href="http://jython.org/">Jython</a>.
      </p>

      <p>
         Further, {{ autobahnpython() }} requires a networking library and currently supports:
         <ul>
            <li><a href="http://twistedmatrix.com/">Twisted</a> and</li>
            <li><a href="http://docs.python.org/3.4/library/asyncio.html">asyncio</a></li>
         </ul>
      </p>

      <p>
         Asyncio comes bundled with CPython 3.4+ and can be installed from <a href="https://pypi.python.org/pypi/asyncio/0.2.1">here</a> on CPython 3.3.
      </p>

      <p>
         Twisted runs best on Python 2 (support for Python 3 is not yet fully complete), but the bits necessary for WebSocket already work on Python 3. For Twisted installation, please follow the instructions on the <a href="http://twistedmatrix.com" target="_blank">Twisted website</a>.
      </p>


      <h2>Installing from Package</h2>

      <p>
         To install the <a href="https://pypi.python.org/pypi/autobahn/">Autobahn|Python Package</a>
         using <a href="http://www.pip-installer.org/en/latest/installing.html" target="_blank">Pip</a>:
      </p>

      {{ beginshell() }}
pip autobahn
      {{ endshell() }}


      <h2>Updating from Package</h2>

      <p>
         To update the <a href="https://pypi.python.org/pypi/autobahn/">Autobahn|Python Package</a>
         using <a href="http://www.pip-installer.org/en/latest/installing.html" target="_blank">Pip</a>:
      </p>

      <div class="shell">
         <pre>
pip install --upgrade autobahn
         </pre>
      </div>


      <h2>Installing from Source</h2>

      <p>
         Source code is available from <a href="https://github.com/tavendo/AutobahnPython" target="_blank">Git repository</a>. To install from sources:
      </p>

      <div class="shell">
         <pre>
git clone git://github.com/tavendo/AutobahnPython.git
cd AutobahnPython
git checkout v0.8.5
cd autobahn
python setup.py install
         </pre>
      </div>

      <p class="warning">
         We are using tags to mark release versions, so just take the latest of these (list tags with "git tag").
         Do NOT use the current HEAD (master branch), since this is where development takes place, and it might
         be broken.
      </p>

      <p class="hint">
         When you don't have Git on your machine, you can download a source code archive package (tar.gz/zip)
         from the GitHub project page.
      </p>


      <h2>Test the Installation</h2>

      <p>To check whether installation was indeed successful:</p>

      <div class="shell">
         <pre>
$ python
Python 2.7.6 (default, Nov 10 2013, 19:24:18) [MSC v.1500 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> import autobahn
>>> autobahn.version
'0.8.5'
         </pre>
      </div>
      <br>

      <a name="yourfirstserver"></a>
      <h1>Your first Server</h1>

      <p>
         Lets fire up a simple WebSocket echo server and test it from a browser.
      </p>

      <p>
         If you are using <b>Asyncio</b>, put the following code into a <a href="{{ url_for('static', filename='file/myserver_asyncio.py') }}">myserver_asyncio.py</a> file:
      </p>
      <div class="codeex">
         <pre class="brush: python; highlight: [5,6,7,8]; toolbar: false; auto-links: false;">
         from autobahn.asyncio.websocket import WebSocketServerProtocol, \
                                                WebSocketServerFactory


         class MyServerProtocol(WebSocketServerProtocol):

            def onMessage(self, payload, isBinary):
               self.sendMessage(payload, isBinary)


         if __name__ == '__main__':

            import asyncio

            factory = WebSocketServerFactory()
            factory.protocol = MyServerProtocol

            loop = asyncio.get_event_loop()
            coro = loop.create_server(factory, '127.0.0.1', 9000)
            server = loop.run_until_complete(coro)

            try:
               loop.run_forever()
            except KeyboardInterrupt:
               pass
            finally:
               server.close()
               loop.close()
         </pre>
      </div>
      <p>
         and start your server by doing
      </p>
      <div class="shell">
         <pre>
python myserver_asyncio.py
         </pre>
      </div>

      <p>
         If you are using <b>Twisted</b>, put the following code into a <a href="{{ url_for('static', filename='file/myserver_twisted.py') }}">myserver_twisted.py</a> file:
      </p>
      <div class="codeex">
         <pre class="brush: python; highlight: [5,6,7,8]; toolbar: false; auto-links: false;">
         from autobahn.twisted.websocket import WebSocketServerProtocol, \
                                                WebSocketServerFactory


         class MyServerProtocol(WebSocketServerProtocol):

            def onMessage(self, payload, isBinary):
               self.sendMessage(payload, isBinary)


         if __name__ == '__main__':

            import sys

            from twisted.python import log
            from twisted.internet import reactor

            log.startLogging(sys.stdout)

            factory = WebSocketServerFactory()
            factory.protocol = MyServerProtocol

            reactor.listenTCP(9000, factory)
            reactor.run()
         </pre>
      </div>
      <p>
         and start your server by doing
      </p>
      <div class="shell">
         <pre>
python myserver_twisted.py
         </pre>
      </div>

      <p>
         Put the following code into a <a href="{{ url_for('static', filename='file/myclient.html') }}">myclient.html</a> file
         and open the file in a browser: xxx
      </p>

      <div class="codeex">
         <script type="syntaxhighlighter" class="brush: xml; highlight: [20,21,22,27]; toolbar: false; auto-links: false;"><![CDATA[
         <!DOCTYPE html>
         <html>
            <head>
               <script type="text/javascript">
                  var sock = null;
                  var wsuri = "ws://localhost:9000";

                  window.onload = function() {

                     sock = new WebSocket(wsuri);

                     sock.onopen = function() {
                        console.log("connected to " + wsuri);
                     }

                     sock.onclose = function(e) {
                        console.log("connection closed (" + e.code + ")");
                     }

                     sock.onmessage = function(e) {
                        console.log("message received: " + e.data);
                     }
                  };

                  function send() {
                     var msg = document.getElementById('message').value;
                     sock.send(msg);
                  };
               &lt;/script&gt;
            </head>
            <body>
               <h1>WebSocket Echo Test</h1>
               <form>
                  <p>
                     Message:
                     <input id="message" type="text" value="Hello, world!">
                  </p>
               </form>
               <button onclick='send();'>Send Message</button>
            </body>
         </html>
         ]]></script>
      </div>

      <p>
         To see logging output, open your browser debugging console
         (e.g. with Chrome or Firefox on Windows, press F12). Click the button to send
         a message and watch the echo'ed messages in the console.
      </p>

      <p class="hint">
         Use a current version of Chrome, Firefox, Safari or IE10+. Support for older
         browsers is there, but things need to be prepared for that.
      </p>
      <br>

      <a name="wheretogo"></a>
      <h1>Where to go now</h1>

      <p>
         Now that you are up and running, check out the <a href="https://github.com/tavendo/AutobahnPython/tree/master/examples">examples</a> available or
         the <a href="/python/reference/">reference documentation</a>.
      </p>

      <p>
         If you want to learn more about making your AutobahnPython servers play with
         browser clients, check out the companion project <a href="{{ url_for('page_js') }}">AutobahnJS</a>.
      </p>

      <p>
         When you want to access your AutobahnPython servers from non-browser clients,
         we develop native Autobahn client libraries for that too. Have a look at whats
         already there, and whats in the queue on the <a href="{{ url_for('page_home') }}">Autobahn</a> project home page.
      </p>

      <p>
         Finally, if you run into problems, have questions or want to contribute,
         don't hesitate to <a href="{{ url_for('page_python_getintouch') }}">join us</a>!
      </p>

   </div> <!-- pagewrapper -->

{% endblock %}
